# PostgreSQLìš© Oracle GoldenGate

<aside>
ğŸ“Œ Oracle GoldenGate 21.3c ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ëœ ë¬¸ì„œ

</aside>

<aside>
ğŸ“– **ëª©ì°¨**

</aside>

# PostgreSQLìš© Oracle GoldenGate

- ì§€ì›ë˜ëŠ” PostgreSQL Database ë²„ì „ì— ëŒ€í•œ ì´ˆê¸° ë¡œë“œ ë° Tx Data ìº¡ì²˜ ë° ì „ë‹¬ì„ ì§€ì›
- ë³„ë„ ì–¸ê¸‰ì´ ì—†ëŠ” í•œ Source Dataì˜ Mapping, Filtering, ë° ë³€í™˜ì„ ì§€ì›
- OGGì—ì„œ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ Source Databaseì—ì„œ íŒŒìƒëœ Dataë¥¼ PostgreSQLë¡œ ë³µì œ ê°€ëŠ¥

# ì§€ì› ì‚¬í•­

## ì§€ì›í•˜ëŠ” DB

- ìº¡ì²˜ ë° ì „ë‹¬ì—ëŠ” ì‚¬ìš©ì DBë§Œ ì§€ì›
- Oracle GoldenGateëŠ” Archive Logì—ì„œ ìº¡ì²˜ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŒ
- ë³µì œë³¸, Standby DBëŠ” ìº¡ì²˜ ë° ì „ë‹¬ì„ ì§€ì›í•˜ì§€ ì•ŠìŒ
- Oracle GoldenGate ExtractëŠ” PostgreSQL HA êµ¬ì„±ì„ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ ì¶”ì¶œì—ì„œ ë³´ì¡° ì¶”ì¶œë¡œ ì›í™œí•œ ì „í™˜ì„ ì§€ì›í•˜ì§€ ì•ŠìŒ

## ì§€ì›í•˜ëŠ” PostgreSQLì˜ Data Type

- `bigint`
- `bit(n)`
- `boolean`
- `char (n)`
- `date`
- `double precision`
- `integer`
- `json`
- `macaddr`
- `money`
- `real`
- `smallint`
- `text`
- `timestamp` ì‹œê°„ëŒ€ í¬í•¨/ì œì™¸
- `varchar(n)`
- `xml`

- `bigserial`
- `bit varying(n)`
- `bytea`
- `cidr`
- `decimal`
- `inet`
- `interval`
- `jsonb`
- `macaddr8`
- `numeric`
- `serial`
- `smallserial`
- `time` ì‹œê°„ëŒ€ í¬í•¨/ì œì™¸
- `uuid`
- `varbit`

### ì§€ì› ì œí•œ ì‚¬í•­

- `char`,Â `varchar`,Â `text`ë˜ëŠ” Data Typeì˜ ì—´ì´Â `bytea` PK ë˜ëŠ” UKì˜ ì¼ë¶€ì¸ ê²½ìš° ì´ëŸ¬í•œ ì—´ì˜ ìµœëŒ€ ê°œë³„ ê¸¸ì´ëŠ” 8191Byteë¥¼ ì´ˆê³¼ ë¶ˆê°€
- `real`,Â `double`,Â `numeric`,Â `decimal`ì€ `NaN` ì…ë ¥ ê°’ ì§€ì› ë¶ˆê°€
- `bit`/Â `varbit` ì œí•œ ì‚¬í•­
    - ê¸¸ì´ ìµœëŒ€ 4k, 4kë³´ë‹¤ í´ ê²½ìš° í•˜ìœ„ 4k ë¹„íŠ¸ ìº¡ì²˜
    - ì†ŒìŠ¤ `bit(n)` ì—´ì€ Non-PostgreSQL ëŒ€ìƒì˜ ë¬¸ì ìœ í˜• ì—´ë§Œ ì ìš©ê°€ëŠ¥
    - PostgreSQL ëŒ€ìƒì˜Â `char`ìœ í˜• ë˜ëŠ”Â `bit/varbit`Â ì—´ì— ì ìš© ê°€ëŠ¥
- `timestamp` ì œí•œ ì‚¬í•­
    - `timestamp`ë°ì´í„°ì— BC ë˜ëŠ” AD íƒœê·¸ê°€ í¬í•¨ëœ ë°ì´í„° ì§€ì› ë¶ˆê°€
    - 1883-11-18Â 12:00:00 ì´ì „ ë°ì´í„° ì§€ì› ë¶ˆê°€
    - `timestamp` YEAR êµ¬ì„±ìš”ì†Œê°€ 4ìë¦¬ ì´ìƒì¸ ë°ì´í„° ì§€ì› ë¶ˆê°€
    - `Infinity/-Infinity`ì—´ì— ëŒ€í•œ ì…ë ¥ ë¬¸ìì—´Â `timestamp` ì§€ì› ë¶ˆê°€
- `date` ì œí•œ ì‚¬í•­
    - `date`ë°ì´í„°ì— BC ë˜ëŠ” AD íƒœê·¸ê°€ í¬í•¨ëœ ë°ì´í„° ì§€ì› ë¶ˆê°€
    - `Infinity`/Â `Infinity`Â ì—´ì— ëŒ€í•œ ì…ë ¥ ë¬¸ìì—´Â `date` ì§€ì› ë¶ˆê°€
- `text`,Â `json`,Â `xml`,Â `bytea`,Â `char (>8191)`ì˜Â ì—´ì€Â `varchar(>8191)` LOB ì—´ë¡œ ì·¨ê¸‰
    - `GETUPDATEBEFORES` LOB ì—´ì˜ ì´ì „ ì´ë¯¸ì§€ ê¸°ë¡ ë¶ˆê°€
    - `NOCOMPRESSUPDATES`í•˜ë©´Â `LOB`Â ì—´ì´ ìˆ˜ì •ëœ ê²½ìš°ë§Œ ì‚¬í›„ ì´ë¯¸ì§€ì— ì—´ ê¸°ë¡ ê°€ëŠ¥
- ë¶€ë™ ì†Œìˆ˜ì  ìˆ«ìì— ëŒ€í•œ ë²”ìœ„ ë° ì •ë°€ë„ ì§€ì›ì€ í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œì— ë”°ë¼ ë‹¤ë¦„
- ì¼ë°˜ì ìœ¼ë¡œ ì •ë°€ë„ëŠ” ìœ íš¨ ìˆ«ì 16ìë¦¬ê¹Œì§€ ì •í™•
- Oracle GoldenGateëŠ” ì§€ì›ë˜ëŠ” ì •ë°€ë„ë¥¼ ì´ˆê³¼í•˜ëŠ” ê°’ì„ ë°˜ì˜¬ë¦¼í•˜ê±°ë‚˜ ìë¦„

## ì§€ì›í•˜ì§€ ì•ŠëŠ” PostgreSQL Data Type

- `Arrays`
- `circle`
- `Domain Types`
- `line`
- `Object Identifiers Types`
- `pg_lsn`
- `point`
- `Pseudo-Types`
- `tsquery`

- `box`
- `Composite Types`
- `Enumerated Types`
- `lseq`
- `path`
- `pg_snapshot`
- `polygon`
- `Range Types`
- `tsvector`

<aside>
âš ï¸ ì§€ì›í•˜ì§€ ì•ŠëŠ” Data Typeì´ ìˆëŠ” Tableì´ í¬í•¨ë  ì‹œ Error MSGì™€ í•¨ê»˜ ì¶”ì¶œ ì¤‘ì§€

ë³µì œ í•˜ê¸° ìœ„í•´ Tableì„ ì§€ìš°ê±°ë‚˜ ì§€ì›í•˜ì§€ ì•ŠëŠ” Data Typeì„ ì œê±°í•´ì•¼ í•¨

</aside>

## ì§€ì›í•˜ëŠ” PostgreSQL Objectì™€ Operation

- DML ì‘ì—…(`INSERT`/`UPDATE`/`DELETE`)ë§Œ ì§€ì›(DDL ë³µì œ ì§€ì› ë¶ˆê°€)
- PostgreSQL 11 ì´ìƒë¶€í„° `TRUNCATE` ì‘ì—… ë³µì œë¥¼ ì§€ì›
    - `GETTRUNCATES` Extract ë° Replicatì— ë§¤ê°œë³€ìˆ˜ í•„ìš”
- ëŒ€ì†Œë¬¸ì êµ¬ë³„
    - ì¸ìš© ë¶€í˜¸ê°€ ì—†ìœ¼ë©´ ëŒ€ì†Œë¬¸ì êµ¬ë¶„í•˜ì§€ ì•ŠìŒ
        - ì•”ì‹œì ìœ¼ë¡œ ì†Œë¬¸ì
        - ex) `CREATE TABLE MixedCaseTable`, `SELECT * FROM mixedcasetable`
    - ì¸ìš©ë¶€í˜¸ì™€ OGG ëª…ë ¹ì´ ì˜¬ë°”ë¥´ê²Œ ì‚¬ìš©ë  ì‹œ ëŒ€ì†Œë¬¸ì êµ¬ë¶„
        - ex)Â `TABLE appschema.â€MixedCaseTableâ€`, `ADD TRANDATA appschema.â€MixedCaseTableâ€`

### Table & View

- ì‚¬ìš©ì ìƒì„± Tableì—ì„œ Transaction DML ìº¡ì²˜ ë° ì‚¬ìš©ì Tableë¡œ ì „ë‹¬ ì§€ì›
- ë¶„í• ëœ Tableì˜ ëª…ì‹œì  ë¶„í•  ìº¡ì²˜ ì§€ì›, ë¶„í• ëœ Tableë¡œì˜ ì „ë‹¬ ì§€ì›
    - ë¶„í• ëœ Table ì´ë¦„ì€ Extractì— ë‚˜ì—´ë¨
        - `TRANDATA`ë¡œ í™œì„±í™”
- Object ì´ë¦„(Table, Schema, Database, Column ì´ë¦„)ê³¼ Column Data ì „ì—­í™” ì§€ì›
- ì œí•œ ì‚¬í•­
    - Viewì— ëŒ€í•œ ìº¡ì²˜ ë° ì „ë‹¬ ì§€ì› ë¶ˆê°€
    - Extractì— ê¸°ë³¸ Tableë§Œ ìˆì„ ê²½ìš° ë¶„í• ëœ Tableì—ì„œ ìº¡ì²˜ ì§€ì›í•˜ì§€ ì•ŠìŒ

### Sequence & Identify Column

- SequenceëŠ” ë‹¨ë°©í–¥, ì–‘ë°©í–¥, ë‹¤ë°©í–¥ êµ¬í˜„ì„ ìœ„í•´ Source Tableê³¼ Target Tableì—ì„œ ì§€ì›
- `GENERATED BY DEFAULT AS IDENTITY`ì ˆì„ ì‚¬ìš©í•´ ìƒì„±ëœ Identify Column ì§€ì›
- `GENERATED ALWAYS AS IDENTITY`ì ˆì„ ì‚¬ìš©í•´ ìƒì„±ëœ Identify Columnì€ Target Database Tableì—ì„œ ì§€ì› ë¶ˆê°€, Identify Propertyë¥¼ Target Database Tableì—ì„œ ì œê±°í•˜ê±°ë‚˜ `GENERATED BY DEFAULT AS IDENTITY`ë¡œ ë³€ê²½í•´ì•¼ ì§€ì› ê°€ëŠ¥
- ì–‘ë°©í–¥, ë‹¤ë°©í–¥ êµ¬í˜„ì˜ `INCREMENT BY`ì˜ ê²½ìš° Server ìˆ˜ì™€ ë™ì¼í•œ ê°’ìœ¼ë¡œ Identify Column ë° Sequenceë¥¼ ì •ì˜í•´ì•¼ í•¨
    - ex1) ì–‘ë°©í–¥, Database 2ê°œ êµ¬ì„±
      
        ```sql
        Database1, set the MINVALUE at 1 with an INCREMENT BY of 2.
        ```
        
        ```sql
        Database2, set the MINVALUE at 2 with an INCREMENT BY of 2.
        ```
        
    - ex2) ë‹¤ë°©í–¥, Database 3ê°œ êµ¬ì„±
      
        ```sql
        Database1, set the MINVALUE at 1 with an INCREMENT BY of 3.
        ```
        
        ```sql
        Database2, set the MINVALUE at 2 with an INCREMENT BY of 3.
        ```
        
        ```sql
        Database3, set the MINVALUE at 3 with an INCREMENT BY of 3.
        ```
        

# DB ì¤€ë¹„

## DB êµ¬ì„±

- `$PGDATA/postgresql.conf`ì˜ ë§¤ê°œ ë³€ìˆ˜ë¥¼ êµ¬ì„±í•´ì•¼ í•¨
    - Extract, Replicatì˜ ì›ê²© ì—°ê²°ì„ ìœ„í•´ `listen_addresses`ë¥¼ ì„¤ì •
        - ex) `$PGDATA/postgresql.conf` `listen_addresses = <remotehost_ip_addr>`
        `[$PGDATA/hba.conf](https://www.postgresql.org/docs/13/auth-pg-hba-conf.html)`ì— OGG ì—°ê²° ì¶”ê°€
- WAL ê´€ë ¨ êµ¬ì„±
    - `wal_level`ì„ `logical`ë¡œ ì§€ì •
    - `max_replication_slots`ëŠ” Extract ìˆ˜ì™€ ë˜‘ê°™ì´ ì§€ì •
        - PostgreSQL ê¸°ë³¸ ë³µì œ ìˆ˜í–‰ ê°’ + Extract ìˆ˜
    - `max_wal_senders`ëŠ” `max_replication_slots`ì™€ ë™ì¼í•˜ê²Œ ì§€ì •
    - ì„ íƒì ìœ¼ë¡œ WALì—ì„œ `COMMIT` Timestamp í™œì„±í™” ê°€ëŠ¥
    - ex)
      
        ```bash
        wal_level = logical            # set to logical for Capture
        
        max_replication_slots = 1      # max number of replication slots,
                                       # one slot per Extract/client
        
        max_wal_senders = 1            # one sender per max repl slot
        
        track_commit_timestamp = on    # optional, correlates tx commit time
                                       # with begin tx log record (useful for      
                                       # timestamp-based positioning)
        ```
        
    - ë³€ê²½ í›„ DB ì¬ì‹œì‘

## OGG Credential

- OGG ProcessëŠ” DB Userê°€ Dataë¥¼ ìº¡ì²˜í•´ PostgreSQL DBë¡œ ì „ë‹¬í•´ì•¼ í•¨
    - OGGìš© Userë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ
- OGGê°€ PostgreSQL DBì—ì„œ ìº¡ì²˜í•˜ê³  ì ìš©í•˜ê¸° ìœ„í•´ ì•„ë˜ í‘œì™€ ê°™ì€ ì‚¬ìš©ì ê¶Œí•œì´ í•„ìš”

| Privilege | Extract | Replicat | Purpose |
| --- | --- | --- | --- |
| CONNECT | Yes | Yes | DB ì—°ê²° í•„ìš”
GRANT CONNECT ON DATABASEÂ dbnameÂ TOÂ gguser; |
| WITH REPLICATION | Yes | NA | ì‚¬ìš©ìê°€ Extractë¥¼ replication slotì— ë“±ë¡í•˜ëŠ”ë° í•„ìš”
ALTER USERÂ gguserÂ WITH REPLICATION; |
| WITH SUPERUSER | Yes | NA | table level supplemental logging (ADD TRANDATA)ì„
í™œì„±í™” í•  ë•Œ í•„ìš”, TRANDATAë¥¼ í™œì„±í™” í•œ í›„ ì·¨ì†Œ ê°€ëŠ¥
ALTER USERÂ gguserÂ WITH SUPERUSER;

Azure DatabaseëŠ” Adminë§Œ SU ê¶Œí•œì´ ìˆìœ¼ë©° ìœ ì¼í•˜ê²Œ TRANDATAë¥¼ í™œì„±í™” í•  ìˆ˜ ìˆëŠ” ìœ ì € |
| USAGE ON SCHEMA | Yes | Yes | ë³µì œí•  Schemaì˜ Tableì— ëŒ€í•œ Data Accessìš©
GRANT USAGE ON SCHEMAÂ tableschemaÂ TOÂ gguser; |
| SELECT ON TABLES | Yes | Yes | Grant select access on tables to be replicated.GRANT SELECT ON ALL TABLES IN SCHEMAÂ tableschemaÂ TOÂ gguser; |
| target table: INSERT, UPDATE, DELETE,TRUNCATE

ëª¨ë“  Table: Â GRANT INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA TO...Â ë¡œ ê¶Œí•œ ë¶€ì—¬í•˜ê±°ë‚˜
Replicat Userì—ê²ŒÂ INSERT, UPDATE, DELETEê¶Œí•œ ë¶€ì—¬ | NA | Yes | Apply replicated DML to target objects.GRANT INSERT, UPDATE, DELETE, TRUNCATE ON TABLEÂ tablenameÂ TO gguser; |
| Heartbeat and Checkpoint Table Privileges |  |  |   |
| CREATE ON DATABASE | Yes | Yes | Required by the Extract and Replicat user to add an Oracle GoldenGate schema for heartbeat and checkpoint table creation.GRANT CREATE ON DATABASEÂ dbnameÂ TO gguser;
Alternatively, ifÂ GGSCHEMAÂ is the same as the user, then the objects can be created under the user by issuingÂ CREATE SCHEMA AUTHORIZATIONÂ ggsuser; |
| CREATE, USAGE ON SCHEMA | Yes | Yes | For heartbeat and checkpoint table creation/deletion if the Extract or Replicat user does not own the objects.
GRANT CREATE, USAGE ON SCHEMAÂ ggschemaÂ TOÂ gguser; |
| EXECUTE ON ALL FUNCTIONS | Yes | Yes | For heartbeat update and purge function execution if the user calling the functions does not own the objects.GRANT EXECUTE ON ALL FUNCTIONS IN SCHEMAÂ ggschemaÂ TOÂ gguser; |
| SELECT, INSERT, UPDATE, DELETE | Yes | Yes | For heartbeat and checkpoint table inserts, updates and deletes if the user does not own the objects.GRANT SELECT, INSERT, UPDATE, DELETE, ON ALL TABLES IN SCHEMAÂ ggschemaÂ TOÂ gguser; |

## DB ì—°ê²° êµ¬ì„±

### Linuxì—ì„œ DB ì—°ê²° êµ¬ì„±

- `/etc/odbc.ini`ì— DSN ì„¤ì •
    - rootë¡œ `vi /etc/odbc.ini`
    
    ```bash
    #Sample DSN entries
    [ODBC Data Sources]
    PG_src=DataDirect 7.1 PostgreSQL Wire Protocol # DNS
    PG_tgt=DataDirect 7.1 PostgreSQL Wire Protocol # DNS
    
    [ODBC]
    IANAAppCodePage=4 # ê¸°ë³¸ê°’, [DB ë¬¸ì ì§‘í•©ì´ Unicodeê°€ ì•„ë‹Œ ê²½ìš° ìˆ˜ì •](https://docs.progress.com/bundle/datadirect-connect-odbc-71/page/IANAAppCodePage_9.html#IANAAppCodePage_9)
    InstallDir=/u01/app/ogg # OGG ì„¤ì¹˜ directory ìœ„ì¹˜
    
    [PG_src]
    Driver=/u01/app/ogg/lib/GGpsql25.so # $OGG_HOME/lib.GGpsq125.so íŒŒì¼ ìœ„ì¹˜
    Description=DataDirect 7.1 PostgreSQL Wire Protocol
    Database=sourcedb # Source, Targetì˜ DB ì´ë¦„
    HostName=remotehost # DB Host IP Address ë˜ëŠ” Host ì´ë¦„
    PortNumber=5432 # DBì˜ ìˆ˜ì‹  Port
    
    [PG_tgt]
    Driver=/u01/app/ogg/lib/GGpsql25.so # $OGG_HOME/lib.GGpsq125.so íŒŒì¼ ìœ„ì¹˜
    Description=DataDirect 7.1 PostgreSQL Wire Protocol
    Database=targetdb # Source, Targetì˜ DB ì´ë¦„
    HostName=remotehost # DB Host IP Address ë˜ëŠ” Host ì´ë¦„
    PortNumber=5432 # DBì˜ ìˆ˜ì‹  Port
    ```
    

### PostgreSQLì— ëŒ€í•œ SSL ì§€ì› êµ¬ì„±

- `$PGDATA/postgresql.conf`ì—ì„œ êµ¬ì„± ë§¤ê°œë³€ìˆ˜ë¥¼ `SSL`ë¡œ ì„¤ì •í•´ SSL í™œì„±í™” ê°€ëŠ¥
- SSLì´ í™œì„±í™” ëœ ê²½ìš° `pg_hba.conf`ì— `hostssl`ì´ íŒŒì¼ì— ìˆê±°ë‚˜ ì¶”ê°€ë˜ì–´ì•¼ í•¨
- SSLì´ í™œì„±í™”ë˜ë©´ Root Certificate, Root CRL(Certification Revocation List), Server Client Certificateì™€ Keyê°€ ì¡´ì¬í•´ì•¼í•¨
  
    ```bash
    ~/.postgresql/root.crt
    ~/.postgresql/root.crl
    ~/.postgresql/postgresql.crt
    ~/.postgresql/postgresql.key
    ```
    
- ê¸°ë³¸ ê²½ë¡œê°€ ì•„ë‹Œ ê²½ë¡œë¥¼ ì‚¬ìš©í•  ë•Œ Enviornment Variableì„ ìˆ˜ì •í•´ì•¼ í•¨
    - `PGSSLROOTCERT`
    - `PGSSLCRL`
    - `PGSSLCERT`
    - `PGSSLKEY`
- `$ODBCINI`íŒŒì¼ì€ `EncryptionMethod DSN` ì†ì„±ì„ ì„¤ì •í•´ SSL ì§€ì› ê°€ëŠ¥
    - `0`(No Encryption): ì•”í˜¸í™” í•˜ì§€ ì•ŠìŒ
    - `1`(SSL): ì•”í˜¸í™” í”„ë¡œí† ì½œ ë²„ì „ ì—°ê²° ì˜µì…˜ì— ì§€ì •ëœ SSL Protocolì„ ì‚¬ìš©í•´ ì•”í˜¸í™”
        - ì§€ì •ëœ ì•”í˜¸í™” ë°©ì‹ì´ DB Serverì—ì„œ ì§€ì›ë˜ì§€ ì•ŠëŠ” ê²½ìš° ì—°ê²° ì‹¤íŒ¨(ì˜¤ë¥˜ ë°˜í™˜)
    - `6`(RequestSSL): ë¡œê·¸ì¸ ìš”ì²­ê³¼ Dataê°€ SSLë¡œ ì•”í˜¸í™”
        - Serverê°€ SSLì— ëŒ€í•´ êµ¬ì„±ë˜ì§€ ì•Šì€ ê²½ìš° ì•”í˜¸í™” í•˜ì§€ ì•ŠìŒ
    
    ```bash
    KeyStore=<path to .p12 keystore file>
    KeyStorePassword=<keystore-passwd>
    TrustStore=<path to root certificate>
    ValidateServerCertificate=1
    ```
    

## Table ì¤€ë¹„

### Targetì˜ Triggerì™€ Constraint ë¹„í™œì„±í™”

- Triggerì™€ Constraintë¥¼ ë¹„í™œì„±í™” í•˜ì§€ ì•Šìœ¼ë©´ ë™ì¼í•˜ê²Œ ë³µì œë˜ì–´ ë°ì´í„°ê°€ ì¤‘ë³µë¨
    - ex) Source Table: `emp_src`, `salary_src` Target Table: `emp_tgt`, `salary_tgt`
        1. `DELETE emp_src`
        2. cascade `DELETE salary_src`
        3. OGGê°€ ë‘ `DELETE`ë¥¼ Targetìœ¼ë¡œ ë³´ëƒ„
        4. ìœ„ `DELETE`ê°€ ë¨¼ì € ì‹¤í–‰ëœ í›„ `emp_tgt`ì— ì ìš©
        5. ìœ„ `DELETE`ê°€ `salary_tgt` ì‚­ì œ
        6. cascaded `DELETE`ê°€ `salary_src`ë¥¼ ì§€ìš°ë©° `salary_tgt`ë„ í•¨ê»˜ ì§€ì›€
        7. 5ì—ì„œ `salary_tgt`ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ

### Tableì˜ Row Uniqueness í™•ì¸

- OGGë¡œ ë³µì œëœ `UPDATE` ë° `DELETE` ëŒ€ìƒì„ ì°¾ê¸° ìœ„í•œ ê³ ìœ í•œ í–‰ ì‹ë³„ìê°€ í•„ìš”
- `TABLEMAP`ì´ë‚˜ `KEYCOLS`ì ˆì´ ì‚¬ìš©ë˜ì§€ ì•Šìœ¼ë©´ ìš°ì„ ìˆœìœ„ì— ë”°ë¼ í–‰ ì‹ë³„ì ì„ íƒ
    1. PK
    2. Timstamp ë˜ëŠ” ê³„ì‚° ì—´ì„ í¬í•¨í•˜ì§€ ì•ŠëŠ” (ì˜ë¬¸ì ìˆœ ì²« ë²ˆì§¸) UK
    3. ì§€ì›í•˜ì§€ ì•ŠëŠ” ì—´ì„ ì œì™¸í•˜ê³  DBì—ì„œ UKë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ì—´ì˜ pseudo key ìƒì„±
    4. Tableì— ì ì ˆí•œ Keyê°€ ì—†ê±°ë‚˜ ê¸°ì¡´ Keyë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë ¤ëŠ” ê²½ìš° Tableì— í•­ìƒ ê³ ìœ í•œ ê°’ì„ í¬í•¨í•˜ëŠ” ì—´ì„ ëŒ€ì²´ í‚¤ë¡œ ì •ì˜ ê°€ëŠ¥
        1. Extractì˜ `TABLE` ë§¤ê°œë³€ìˆ˜ì— `KEYCOLS`ì ˆ í¬í•¨
        2. Replicatì˜ `MAP` ë§¤ê°œë³€ìˆ˜ì— `KEYCOLS`ì ˆ í¬í•¨

### Table Level Supplemental Logging í™œì„±í™”

- Supplemental Logging í™œì„±í™”ëŠ” OGGê°€ Source DML ì‘ì—…ì˜ CDCë¥¼ ì§€ì›
- Logging Levelì— ë”°ë¼ ì´ì¤‘ ë°ì´í„°ì™€ ê°™ì€ ê²½ìš° í•„ìš”í•  ìˆ˜ ìˆëŠ” ë³€ê²½ë˜ì§€ ì•Šì€ ì¶”ê°€ ì—´ì„ í¬í•¨í•˜ë„ë¡ Source Database Table Level Supplemental Loggingì„ ì„¤ì •í•˜ëŠ” ì‘ì—…
- PostgreSQLì´ ì§€ì›í•˜ëŠ” Table Level Supplemental Log(`REPLICA IDENTITY`ì™€ ë™ì¼)
    1. `NOTHING`: OGGì—ì„œ ì§€ì›í•˜ì§€ ì•ŠìŒ
    2. `USING INDEX`: OGGì—ì„œ ì§€ì›í•˜ì§€ ì•ŠìŒ
    3. `DEFAULT`: PK, ê³ ìœ  Indexê°€ ìˆê±°ë‚˜ ì „ì²´ Before Image ë˜ëŠ” ì••ì¶• ì•ˆí•œ ê¸°ë¡ì´ í•„ìš”í•œ ê²½ìš°
       
        ```bash
        ADD TRANDATA <schema>.<table> KEYCOLS
        ```
        
    4. `FULL`: ì „ì²´ Before Image ë˜ëŠ” ì••ì¶•í•˜ì§€ ì•Šì€ ê¸°ë¡ í•„ìš”í•œ ê²½ìš°
       
        ```bash
        ADD TRANDATA <schema>.<table> ALLCOLS
        ```
    
- Tableì˜ Supplemental Logging Levelì„ í™•ì¸í•˜ëŠ” ë°©ë²•
  
    ```bash
    INFO TRANDATA <schema>.<table>
    ```
    

# Extract êµ¬ì„±

## Extract ì •ë³´

### Initial Load Extract

- Initial Load ExtractëŠ” Tableì—ì„œ ëª¨ë“  Recordë¥¼ ì½ê³  `EXTFILE` í˜¹ì€ `RMTFILE`ì— ì“°ëŠ”ë° ì‚¬ìš©
- Initial Load ExtractëŠ” `ADD EXTRACT` ëª…ë ¹ì˜ `SOURCEISTABLE` ì˜µì…˜ì„ ì‚¬ìš©í•´ ìƒì„±
    - ë³µêµ¬ë¥¼ ìœ„í•œ Checkpointë¥¼ ìœ ì§€í•˜ì§€ ì•ŠìŒ

### CDC Extract

- CDC ExtractëŠ” WALì— ìƒì„±ë˜ê±°ë‚˜ ë°°ì¹˜ëœ ì‹œì ì—ì„œ Transaction Dataì˜ ë³€ê²½ì‚¬í•­ì„ ìº¡ì²˜
- PostgreSQLìš© OGG Extract ProcessëŠ” PostgreSQL `test_decoding` DB Pluginì—ì„œ Logical Recordë¥¼ ìˆ˜ì‹ í•˜ê³  Replicatì´ Downstreamì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ `COMMIT` ìˆœì„œëŒ€ë¡œ Trail Fileì— ê¸°ë¡

### Extract ë°°í¬ ì˜µì…˜

- Local Deployment
    - ì›ë³¸ DBì™€ OGGê°€ ë™ì¼í•œ Serverì— ì„¤ì¹˜
    - ì¶”ê°€ ê³ ë ¤ì‚¬í•­ ì—†ìŒ
- Remote Deployment
    - ì›ë³¸ DBì™€ OGGê°€ ë‹¤ë¥¸ Serverì— ì„¤ì¹˜(ex: Azure for PostgreSQL ë“±)
    - DB Serverì™€ OGG Serverì˜ Endianì´ ê°™ì•„ì•¼ ì§€ì› ê°€ëŠ¥
    - OGG Serverì˜ Server ì‹œê°„ê³¼ ì‹œê°„ëŒ€ê°€ DB Serverì™€ ë™ê¸°í™”ë˜ì–´ì•¼ í•¨
        - ë¶ˆê°€ëŠ¥ í•  ì‹œ Extractë¥¼ ìƒì„±í•˜ê±°ë‚˜ ë³€ê²½í•  ë•Œ LSNìœ¼ë¡œ Extract ìœ„ì¹˜ ì§€ì •
    - Remote CDCì—ì„œ Extractê°€ ì²˜ë¦¬í•˜ëŠ” ê° Recordì˜ ì‘ì—…ì´ ìˆœì°¨ì ì´ì—¬ì•¼í•˜ë¯€ë¡œ SQLEXECë¥¼ ì‚¬ìš©í•  ì‹œ ëŒ€ê¸°ì‹œê°„ì´ ì¶”ê°€ë¡œ í•„ìš”í•  ìˆ˜ ìˆìŒ
    - Network ëŒ€ê¸° ì‹œê°„ì´ ë‚®ì€ ê²ƒì´ ì¤‘ìš”í•¨(Oracleì‚¬ ê¶Œì¥ 1ms ë¯¸ë§Œ)

## Extract ìƒì„±ì‹œ ì „ì œ ì¡°ê±´

### PostgreSQLìš© Extract ë“±ë¡

- PostgreSQLìš© ExtractëŠ” DBì— ë“±ë¡ê³¼ ì˜ˆì•½ ëœ Replication Slotì´ í• ë‹¹ë˜ì–´ì•¼ í•¨
- Replication Slotì€ DB êµ¬ì„± ì„¤ì •ì„ í†µí•´ í• ë‹¹ë˜ë©° `max_replication_slots`ë¡œ ì„¤ì •
- Classic Architectureì—ì„œ Extract ë“±ë¡
    1. GGSCIì—ì„œ `DBLOGIN`
       
        ```bash
        DBLOGIN SOURCEDB <DSN> USERID <userid> PASSWORD <userpw>
        ```
        
    2. `REGISTER EXTRACT`ëª…ë ¹ìœ¼ë¡œ Extract ë“±ë¡
       
        ```bash
        REGISTER EXTRACT <extname>
        ```
        
        - Extract ì´ë¦„ì€ ì˜ë¬¸ì 8ìë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŒ
        - ë‚´ë¶€ì ìœ¼ë¡œ Replication Slotì´ ìƒì„±ë¨

## CDC ìƒì„±

- Transaction Dataë¥¼ ìº¡ì²˜í•˜ë„ë¡ CDC Extract êµ¬ì„±
1. ìœ„ ëª…ë ¹ìœ¼ë¡œ ë“±ë¡í•œ Extract ë§¤ê°œë³€ìˆ˜ íŒŒì¼ ìƒì„±
   
    ```bash
    EDIT PARAMS <extname>
    ```
    
2. Extractì˜ ë§¤ê°œë³€ìˆ˜ ì…ë ¥
   
    ```bash
    EXTRACT <extname>
    SOURCEDB <dsn> USERID <userid> PASSWORD <userpw>
    EXTTRAIL ./dirdat/<trail alias>
    GETTRUNCATES
    TABLE <schema>.<table>;
    ```
    
    | ë§¤ê°œë³€ìˆ˜ | ì„¤ëª… |
    | --- | --- |
    | EXTRACT <extname> | ì˜ë¬¸ì 8ì ì´í•˜ |
    | SOURCEDB <dsn> | DBì—°ê²° DSN ì´ë¦„ ì§€ì • |
    | USERID <userid> PASSWORD <userpw> | í•´ë‹¹ USERë¡œ ë¡œê·¸ì¸ |
    | EXTTRAIL ./dirdat/<trail alias> | Extractê°€ ìº¡ì²˜í•œ Dataë¥¼ ê¸°ë¡í•˜ëŠ” 2ê¸€ìì˜ Local Extarct Alias |
    | GETTRUNCATES | Truncateë¥¼ ìº¡ì²˜í•˜ëŠ”ë° í•„ìš” |
    | TABLE <schema>.<table>; | Data ìº¡ì²˜í•  schemaì™€ table
    ;ìœ¼ë¡œ ë§¤ê°œë³€ìˆ˜ ëª…ë ¹ ì¢…ë£Œ
    
    SCHEMAEXCLUDE, TABLEEXCLUDE, EXCLUDEWILDCARDOBJECTSONLY ë§¤ê°œë³€ìˆ˜ë¡œ *ë¡œ ì§€ì •í•œ ê²ƒ ì¤‘ ì œì™¸ |
3. Extractì™€ Trail íŒŒì¼ ì¶”ê°€
   
    ```bash
    ADD EXTRACT <extname>, TRANLOG, BEGIN NOW
    ADD EXTTRAIL ./dirdat/<trail alias>, EXTRACT <extname>
    ```
    
4. ì¶”ì¶œ ì‹œì‘
   
    ```bash
    START EXTRACT <extname>
    ```
    

# Replicat êµ¬ì„±

## Replicat ì •ë³´

- PostgreSQLìš© OGG Replicatì€ Extractì—ì„œ Dataë¥¼ ì½ê³  ëŒ€ìƒ PostgreSQL DBì— ì „ë‹¬
- Extract DataëŠ” OGG ìº¡ì²˜ê°€ ì§€ì›í•˜ëŠ” ëª¨ë“  DBì— ì „ë‹¬ ê°€ëŠ¥
- PostgreSQLì—ì„œ ì‚¬ìš©ê°€ëŠ¥í•œ Replicatì€ Classic, Coordinated, Parallel Replicat

### Replicat ë°°í¬ ì˜µì…˜

- Local Deployment
    - ì›ë³¸ DBì™€ OGGê°€ ë™ì¼í•œ Serverì— ì„¤ì¹˜
    - ì¶”ê°€ ê³ ë ¤ì‚¬í•­ ì—†ìŒ
- Remote Deployment
    - ì›ë³¸ DBì™€ OGGê°€ ë‹¤ë¥¸ Serverì— ì„¤ì¹˜(ex: Azure for PostgreSQL ë“±)
    - DB Serverì™€ OGG Serverì˜ Endianì´ ê°™ì•„ì•¼ ì§€ì› ê°€ëŠ¥
    - OGG Serverì˜ Server ì‹œê°„ê³¼ ì‹œê°„ëŒ€ê°€ DB Serverì™€ ë™ê¸°í™”ë˜ì–´ì•¼ í•¨
        - ë¶ˆê°€ëŠ¥ í•  ì‹œ Extractë¥¼ ìƒì„±í•˜ê±°ë‚˜ ë³€ê²½í•  ë•Œ LSNìœ¼ë¡œ Extract ìœ„ì¹˜ ì§€ì •
    - Remote CDCì—ì„œ Extractê°€ ì²˜ë¦¬í•˜ëŠ” ê° Recordì˜ ì‘ì—…ì´ ìˆœì°¨ì ì´ì—¬ì•¼í•˜ë¯€ë¡œ SQLEXECë¥¼ ì‚¬ìš©í•  ì‹œ ëŒ€ê¸°ì‹œê°„ì´ ì¶”ê°€ë¡œ í•„ìš”í•  ìˆ˜ ìˆìŒ
    - Network ëŒ€ê¸° ì‹œê°„ì´ ë‚®ì€ ê²ƒì´ ì¤‘ìš”í•¨(Oracleì‚¬ ê¶Œì¥ 1ms ë¯¸ë§Œ)

## Replicat ìƒì„±ì‹œ ì „ì œ ì¡°ê±´

## Checkpoint Table ìƒì„±

- Checkpoint Tableì€ Replicatì„ ì¬ì‹œì‘í•  ë•Œ ë³µêµ¬ í¬ì§€ì…”ë‹ì„ ìœ„í•´ Target DBì˜ Replicatì—ì„œ ì‚¬ìš©
- Classic ReplicatëŠ” ì„ íƒ(ê¶Œì¥) ì‚¬í•­ì´ë©° Coordinated ë° Parallel Replicatì˜ ê²½ìš° í•„ìˆ˜ ì‚¬í•­
- Parallel Replicatì˜ Checkpoint Tableì€ Replicat ì¶”ê°€ ì‹œ ìƒì„±ë˜ì–´ ë¯¸ë¦¬ ìƒì„±í•˜ì§€ ì•Šì•„ë„ ë¨
- Classic Replicatì˜ Checkpoint Table ìƒì„±
    1. GGSCIë¥¼ ì‚¬ìš©í•´ Target DBì˜ DSNì— ì—°ê²°
       
        ```bash
        DBLOGIN SOURCEDB <dsn> USERID <userid> PASSWORD <userpw>
        ```
        
    2. Checkpoint Table ì¶”ê°€
       
        ```bash
        ADD CHECKPOINTTABLE <ggadmin>.<oggcheck>
        ```
        

## Replicat ìƒì„±

- Target PostgreSQL Tableì— Transaction Dataë¥¼ ì „ë‹¬í•˜ê¸° ìœ„í•´ Replicat ìƒì„±
1. Replicat ë§¤ê°œë³€ìˆ˜ íŒŒì¼ ìƒì„±
   
    ```bash
    EDIT PARAM <repname>
    ```
    
    - Replicatì˜ ì´ë¦„ì€ Classicì€ ì˜ë¬¸ì 8ì ì´í•˜ Coordinatedì™€ Parallelì€ ì˜ë¬¸ì 5ì ì´í•˜
2. Replicat ë§¤ê°œë³€ìˆ˜ ì…ë ¥
   
    ```bash
    REPLICAT <repname>
    TARGETDB <dsn> USERID <userid> PASSWORD <userpw>
    BATCHSQL
    GETTRUNCATES
    MAP <schema>.<object>, TARGET <schema>.<object>
    ```
    
    | ë§¤ê°œë³€ìˆ˜ | ì„¤ëª… |
    | --- | --- |
    | REPLICAT <repname> | Classicì˜ ê²½ìš° 8ì ì´í•˜, Coordinatedì™€ Parallel 5ì ì´í•˜ |
    | TARGETDB <dsn> | DB ì—°ê²° DSN ì´ë¦„ |
    | USERID <userid> PASSWORD <userpw> | í•´ë‹¹ Userë¡œ ë¡œê·¸ì¸ |
    | BATCHSQL
    GETTRUNCATES | Transaction ì¼ê´„ ì²˜ë¦¬ ë° TRUNCATE ì‘ì—…ì˜ ë³µì œ ì§€ì› |
    | MAP <schema>.<object>, 
    TARGET <schema>.<object> | ì›ë³¸ Tableê³¼ Target Tableì˜ ê´€ê³„ ì§€ì • |
3. (ì„ íƒ)Parallel Replicat ì¶”ê°€
   
    ```bash
    ADD REPLICAT <repname>, PARALLEL, EXTTRAIL ./dirdat/<trail alias>, CHECKPOINTTABLE <ggadmin>.<oggcheck>
    ```
    

# ì¶”ê°€ ê³ ë ¤ ì‚¬í•­

## Heart Beat Table ì¶”ê°€

- PostgreSQLìš© OGGëŠ” Heart Beat Table êµ¬ì„±ì„ ì§€ì›
    - `UPDATE`ì™€ `DELETE`ì— ì œí•œ ì‚¬í•­ì´ ìˆìŒ
- DB Schemaë¥¼ ìƒì„±í•´ì•¼ í•¨
    - `GLOBALS` íŒŒì¼ì˜ ë§¤ê°œë³€ìˆ˜ `GGSCHEMA`ì™€ ì´ë¦„ì´ ì¼ì¹˜í•´ì•¼ í•¨
    - Extractë‚˜ Replicat Userì™€ ë™ì¼í•˜ì§€ ì•Šì€ ê³ ìœ í•œ Schemaì´ê±°ë‚˜ OGG Object ì „ìš©ìœ¼ë¡œ ì˜ˆì•½
    - Replicate ë˜ì§€ ì•ŠëŠ” User Table Schemaì—¬ì•¼ í•¨
- Classic êµ¬ì„±
    1. GGSCIë¥¼ ì‚¬ìš©í•´ Source ë° Target DBì˜ DSNì— ì—°ê²°
       
        ```bash
        DBLOGIN [SOURCEDB | TARGETDB] <dsn> USERID <userid> PASSWORD <userpw>
        ```
        
    2. `ADD HEARTBEATTABLE`
       
        ```bash
        ADD HEARTBEATTABLE
        ```
        
    3. (ì„ íƒ)ë‹¨ë°©í–¥ Replicateì—ë§Œ ì‚¬ìš©ë˜ëŠ” Target DBì˜ Heart Beat Record `UPDATE` ê¸°ëŠ¥ì„ ìƒì„±í•˜ì§€ ì•ŠëŠ” `TARGETONLY`ì˜µì…˜ í¬í•¨ ê°€ëŠ¥
       
        ```bash
        ADD HEARTBEATTABLE TARGETONLY
        ```
        

### Heart Beat `UPDATE` & `DELETE`

- Heart Beat Table ë° ê´€ë ¨ í•¨ìˆ˜ëŠ” `ADD HEARTBEATTABLE`ë¡œ ìƒì„±ë˜ë‚˜ PostgreSQLì€ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ìë™ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ì—†ìŒ
- Heart Beat Record `UPDATE`ì™€ `DELETE`ë¥¼ ì œì–´í•˜ëŠ” í•¨ìˆ˜ê°€ ìˆìŒ
- ê¸°ë³¸ Heart Beat Record í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë ¤ë©´ ì•„ë˜ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•´ì•¼ í•¨
  
    ```sql
    SELECT <ggschema>.gg_hb_job_run();
    ```
    

## ì–‘ë°©í–¥ Loop ê°ì§€ í™œì„±í™”

- Loop ê°ì§€ë¡œ OGGì˜ ì–‘ë°©í–¥ êµ¬í˜„ì—ì„œ ë‹¤ë¥¸ Source DBì˜ Replicatì´ ë³´ë‚¸ Transaction ìº¡ì²˜ ë°©ì§€
- Replicatì— ì˜í•´ ë‹¤ì‹œ ì ìš©ëœ ìº¡ì²˜ë¥¼ ë¬´ì‹œí•˜ê¸° ìœ„í•´ `TANLOGOPTIONS FILTERTABLE` ë§¤ê°œë³€ìˆ˜ ì‚¬ìš©
- í•„í„°ë§ Tableë¡œ ì‚¬ìš©ë˜ëŠ” Tableì€ Replicatì— ëŒ€í•´ ìƒì„±í•´ì•¼ í•˜ëŠ” OGG Checkpoint Tableì´ ë¨
    - Classicê³¼ Coordinated Replicatë§Œ ì–‘ë°©í–¥ ë° ë‹¤ë°©í–¥ Replication ì§€ì›
- í•„í„°ë§ Tableì„ ìƒì„±í•˜ê³  Supplemental Loggingì„ í™œì„±í™” í•˜ëŠ” ë°©ë²•
    1. ê° Source DBì—ì„œ Replicatì´ ì‚¬ìš©í•˜ëŠ” Checkpoint Tableì´ ìˆëŠ”ì§€ í™•ì¸
       
        ```bash
        ADD CHECKPOINTTABLE <ggadmin>.<oggcheck>
        ```
        
        - GLOBALS íŒŒì¼ì˜ `GGSCHEMA` ë§¤ê°œë³€ìˆ˜ì™€ ë™ì¼í•œ Schema ì´ë¦„ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥
    2. Checkpoint Tableì— ëŒ€í•œ Supplemental Logging í™œì„±í™”
       
        ```bash
        ADD TRANDATA <ggadmin>.<oggcheck> ALLCOLS
        ```
        
    3. Checkpoint Table ì •ë³´ë¡œ Replicatì´ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸
       
        ```bash
        ADD REPLICAT <repname>, EXTTRAIL ./dirdat/<trail alias> CHECKPOINTTABLE <ggadmin>.<oggcheck>
        ```
        
    4. í•„í„°ë§ Tableì— ëŒ€í•´ Replicatì˜ Checkpoint Tableì„ ì‚¬ìš©í•´ `IGNOREREPLICATES`(Default)ì™€ `FILTERTABLE` ë§¤ê°œë³€ìˆ˜ë¡œ ê° Extractë¥¼ êµ¬ì„±
       
        ```bash
        TRANLOGOPTIONS IGNOREREPLICATES
        TRANLOGOPTIONS FILTERTABLE ggadmin.oggcheck
        ```
        

## Extract ì‚­ì œ

- Source PostgreSQL DBì— ëŒ€í•œ ê°œë³„ Extractë¥¼ ì œê±°í•˜ê±°ë‚˜ OGGë¥¼ ì œê±°í•  ë•Œ Replication slot í•­ëª©ì„ ì œê±°í•˜ë ¤ë©´ DB Replication Slotì— ë“±ë¡ëœ Extractë¥¼ ë“±ë¡ í•´ì œí•´ì•¼ í•¨
    - ì œê±°í•˜ì§€ ì•Šì„ ì‹œ DB Log í¬ê°€ê°€ ì¦ê°€í•´ì„œ ë°œìƒ
- Classic Architecture
    1. GGSCIë¥¼ ì‚¬ìš©í•´ Source ë° Target DBì˜ DSNì— ì—°ê²°
       
        ```bash
        DBLOGIN [SOURCEDB | TARGETDB] <dsn> USERID <userid> PASSWORD <userpw>
        ```
        
    2. DELETE EXTRACT
       
        ```bash
        DELETE EXTRACT <extname>
        ```
        
    3. UNREGISTER EXTRACT
       
        ```bash
        UNREGISTER EXTRACT <extname>
        ```
        

## Table Level Supplemental Logging ì œê±°

- OGGì—ì„œ ë” ì´ìƒ Tableì„ ìº¡ì²˜í•  í•„ìš”ê°€ ì—†ê³  Tableì— ëŒ€í•œ ë§¤ê°œë³€ìˆ˜ `TABLE`ì´ Extract ë§¤ê°œë³€ìˆ˜ íŒŒì¼ì—ì„œ ì œê±°ë˜ì—ˆê±°ë‚˜ ì œì™¸ëœ ê²½ìš° Tableì—ì„œ Supplemental Loggingì„ ì œê±° ê°€ëŠ¥

```bash
DBLOGIN SOURCEDB <dsn> USERID <userid> PASSWORD <userpw>

DELETE TRANDATA <schema>.<table> # ì œê±°

INFO TRANDATA <schema>.<table> # Supplemental Logging Level í™•ì¸
```

# OGG PostgreSQL Extract ì‹¤ìŠµ

1. Yum install uinxODBC
   
    ```bash
    yum install unixODBC unixODBC-devel postgresql<ver>-odbc
    ```
    
2. Environment Variable ìˆ˜ì •
   
    ```bash
    export LD_LIBRARY_PATH=$PG_HOME/lib:$OGG_HOME/lib:$LD_LIBRARY_PATH
    
    export ODBCINI=/<odbc.ini PATH>
    ```
    
3. odbc.ini ìƒì„± ë° ìˆ˜ì •
   
    ```bash
    [ODBC Data Sources]
    
    Postgres=DataDirect 11 PostgreSQL Wire Protocol
    
    [ODBC]
    
    IANAAppCodePage=106
    
    InstallDir=/home/ark053/ogg
    
    [Postgres]
    
    Driver=/home/ark053/ogg/lib/GGpsql25.so
    
    Description=DataDirect 11 PostgreSQL Wire Protocol
    
    Servername=localhost
    
    Servertype=postgres
    
    Database=test
    
    HostName=localhost
    
    PortNumber=5432
    
    LogonID=test
    
    Password=test
    ```
    
4. OGG ì„¤ì¹˜í•œ ê³„ì •ì—ì„œ isql ì‹¤í–‰
   
    ```bash
    isql -v Postgres test test
    +---------------------------------------+
    | Connected!                            |
    |                                       |
    | sql-statement                         |
    | help [tablename]                      |
    | quit                                  |
    |                                       |
    +---------------------------------------+
    ```
    
5. ggsci ì‹¤í–‰ ë° Sub-Directory ë§Œë“¤ê¸°
   
    ```bash
    ./ggsci
    
    CREATE SUBDIRS
    ```
    
6. EDIT PARAM MGR PORT 7809
   
    ```bash
    EDIT PARAM MGR PORT 7809
    ```
    
7. Replication Slot ë§Œë“¤ê¸°
   
    ```bash
    REGISTER EXTRACT ext01
    ```
    
8. dblogin
   
    ```bash
    DBLOGIN SOURCEDB Postgres USERID test PASSWORD test
    ```
    
9. ADD TRANDATA
   
    ```bash
    ADD TRANDATA <schema>.<tablename> [ALLCOLS | <>]
    
    # ALLCOLS = REPLICA IDENTITY FULL
    add trandata test.test_f allcols
    
    Logging of supplemental log data is enabled for table test.test_f. REPLICA IDENTITY was DEFAULT and is changed to FULL
    
    # <>(ê³µë°±) = REPLICA IDENTITY DEFAULT
    add trandata test.test_d
    
    Logging of supplemental log data is already enabled for table test.test_d with REPLICA IDENTITY set to DEFAULT
    ```
    
10. ADD EXTRACT & EXTTRAIL
    
    ```bash
    ADD EXTRACT <extname>, TRANLOG, BEGIN NOW
    
    ADD EXTTRAIL ./dirdat/<alias>, EXTRACT <extname>
    ```
    
11. Make Extract Parameter File
    
    ```bash
    EDIT PARAM ext01
    
    ###
    EXTRACT ext01
    
    SOURCEDB Postgres USERID test PASSWORD test
    
    EXTTRAIL ./dirdat/ea TABLE test.test_f;
    
    TABLE test.test_f;
    ###
    ```
    
12. START MGR & EXTRACT
    
    ```bash
    START MGR
    START EXTRACT ext01
    INFO ALL
    ```
    
13. Logdumpì— í™•ì¸ ì„±ê³µ!!

![Untitled](./Oracle GoldenGate for PostgreSQL/Untitled.png)

![Untitled](./Oracle GoldenGate for PostgreSQL/Untitled%201.png)

[Using Oracle GoldenGate for Heterogeneous Databases](https://docs.oracle.com/en/middleware/goldengate/core/21.3/gghdb/using-oracle-goldengate-postgresql.html)